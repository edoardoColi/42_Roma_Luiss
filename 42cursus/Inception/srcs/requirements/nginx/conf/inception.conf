###########################################################################
# File generated by ChatGPT + Ecoli to setup nginx for Inception project. #
###########################################################################
server {
 listen 443 ssl;
 listen [::]:443 ssl;  # Listen on IPv6 as well
 server_name ecoli.42.fr www.ecoli.42.fr;  # Domain name

 root   /var;
 index  MySite/index.html WordPress/index.php WordPress/index.html WordPress/index.htm;  #Priority presence (index.htm may still be encountered in some legacy systems)

## SSL/TLS certificate and key paths
 ssl_certificate /etc/nginx/ssl/inception.crt;
 ssl_certificate_key /etc/nginx/ssl/inception.key;

## SSL/TLS settings
 ssl_protocols TLSv1.2 TLSv1.3;
 ssl_ciphers 'TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384';
 ssl_prefer_server_ciphers off;

#### Other Nginx settings to configure how Nginx handles requests for your website ####

## For handling requests to the root URL path ("/") of your web server if missing index.html in root
 location / {
        autoindex on;  # Enables directory listing from root
        try_files $uri $uri/ =404;
 }

location ~ \.php$ {
        # fastcgi_split_path_info ^(.+\.php)(/.+)$;
        fastcgi_pass wordpress:9000; # Use the PHP-FPM container's name as the hostname
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        # fastcgi_param PATH_INFO $fastcgi_path_info;
        include fastcgi_params;
}
       
## For handling requests of .php
#  location ~ \.php$ {
#         fastcgi_split_path_info ^(.+\.php)(/.+)$;
#         fastcgi_pass wordpress:9000;
#         fastcgi_index index.php;
#         include fastcgi_params;
#         fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
#         fastcgi_param PATH_INFO $fastcgi_path_info;
#  }

# ## For handling requests as everything is a 404
#  location / {
#         return 404;
#  }
# ## You may need this to prevent return 404 recursion.
#  location = /404.html {
#         internal;
#  }

# ## For proxy
#  location / {
#     proxy_pass http://your_backend_server;
#     # Additional proxy settings if needed
#  }

}
